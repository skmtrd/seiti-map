# Supabase ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šã‚¬ã‚¤ãƒ‰

## ğŸš€ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œæ‰‹é †

### 1. Supabase CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npm install -g supabase
```

### 2. Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§å®Ÿè¡Œ
supabase init

# æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ãƒªãƒ³ã‚¯
supabase link --project-ref wvrxoutiubnthnhqwsuv
```

### 3. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚’èµ·å‹•
supabase start

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
supabase db push

# æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
supabase db push --linked
```

## ğŸ“ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°

### å®Ÿè¡Œé †åºï¼ˆè‡ªå‹•ï¼‰
1. `20241201120000_create_seiti_map_schema.sql`
2. `20241201120001_create_rls_policies.sql` 
3. `20241201120002_create_storage_setup.sql`
4. `20241201120003_create_triggers.sql`

### å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹

#### 1. ãƒ¡ã‚¤ãƒ³ã‚¹ã‚­ãƒ¼ãƒä½œæˆ
- ENUMã‚¿ã‚¤ãƒ—å®šç¾©
- 9ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
- ä½œå“é‡è¤‡ãƒã‚§ãƒƒã‚¯é–¢æ•°

#### 2. RLSãƒãƒªã‚·ãƒ¼è¨­å®š
- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼
- ãƒ­ãƒ¼ãƒ«åˆ¥æ¨©é™è¨­å®šï¼ˆanon/authenticatedï¼‰
- CRUDæ“ä½œåˆ¥ãƒãƒªã‚·ãƒ¼åˆ†é›¢

#### 3. Storageè¨­å®š
- 3ã¤ã®ãƒã‚±ãƒƒãƒˆä½œæˆï¼ˆspot-images, work-posters, user-avatarsï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™è¨­å®š

#### 4. ãƒˆãƒªã‚¬ãƒ¼è¨­å®š
- è‡ªå‹•ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æ›´æ–°
- ãƒ¦ãƒ¼ã‚¶ãƒ¼çµ±è¨ˆæƒ…å ±è‡ªå‹•æ›´æ–°
- ã‚¹ãƒãƒƒãƒˆé–²è¦§æ•°è‡ªå‹•ã‚«ã‚¦ãƒ³ãƒˆ

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### âœ… å®Ÿè£…æ¸ˆã¿é …ç›®
- [x] Row Level Security (RLS) å…¨ãƒ†ãƒ¼ãƒ–ãƒ«æœ‰åŠ¹
- [x] ãƒ­ãƒ¼ãƒ«åˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆanon/authenticatedï¼‰
- [x] ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰€æœ‰ãƒ‡ãƒ¼ã‚¿ã®ã¿ç·¨é›†ãƒ»å‰Šé™¤å¯èƒ½
- [x] Storage ãƒ•ã‚©ãƒ«ãƒ€åˆ†é›¢ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- [x] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆSupabase Authæ¨™æº–ï¼‰

### âš ï¸ é‹ç”¨æ™‚æ³¨æ„ç‚¹
- æœ¬ç•ªç’°å¢ƒã§ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿å–ã‚Šæ‰±ã„
- APIã‚­ãƒ¼ã®é©åˆ‡ãªç®¡ç†
- RLSãƒãƒªã‚·ãƒ¼ã®å®šæœŸçš„ãªè¦‹ç›´ã—
- ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
supabase migration list

# ç‰¹å®šãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆ
supabase db reset

# å†å®Ÿè¡Œ
supabase db push
```

### é–‹ç™ºç’°å¢ƒãƒªã‚»ãƒƒãƒˆ
```bash
# å®Œå…¨ãƒªã‚»ãƒƒãƒˆ
supabase stop
supabase start
```

### æœ¬ç•ªç’°å¢ƒã§ã®æ³¨æ„
```bash
# å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å–å¾—å¾Œã«å®Ÿè¡Œ
supabase db dump --linked > backup.sql

# æ®µéšçš„é©ç”¨æ¨å¥¨
supabase db push --linked --dry-run  # äº‹å‰ç¢ºèª
supabase db push --linked           # å®Ÿéš›ã®é©ç”¨
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆç¢ºèª

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ç¢ºèª
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public';
```

### RLSãƒãƒªã‚·ãƒ¼ç¢ºèª
```sql
SELECT 
  tablename, 
  policyname, 
  roles, 
  cmd 
FROM pg_policies 
WHERE schemaname = 'public';
```

### Storage ãƒã‚±ãƒƒãƒˆç¢ºèª
```sql
SELECT * FROM storage.buckets;
```

## ğŸ” ç’°å¢ƒå¤‰æ•°è¨­å®š

### å¿…é ˆç’°å¢ƒå¤‰æ•°
```env
NEXT_PUBLIC_SUPABASE_URL=https://wvrxoutiubnthnhqwsuv.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
```

### å–å¾—æ–¹æ³•
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±è¡¨ç¤º
supabase status
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [DATABASE_SCHEMA.md](../DATABASE_SCHEMA.md) - è©³ç´°ãªã‚¹ã‚­ãƒ¼ãƒä»•æ§˜
- [Supabase å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://supabase.com/docs)
- [PostgreSQL ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://www.postgresql.org/docs/)

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

### å•é¡Œç™ºç”Ÿæ™‚ã®é€£çµ¡å…ˆ
1. GitHub Issues ã§ã®å ±å‘Š
2. Supabase Discord ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹ç™ºãƒãƒ¼ãƒ 

---

**ä½œæˆæ—¥**: 2024å¹´12æœˆ1æ—¥  
**å¯¾è±¡ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**Supabase CLI æœ€å°ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.100.0 